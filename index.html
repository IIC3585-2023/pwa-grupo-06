<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="./icons/icon-192.png" />
    <title>PWA Grupo 6</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="stylesheet" href="./style.css" />
    <script src="https://cdn.jsdelivr.net/npm/idb@7/build/umd.js"></script>
  </head>

  <body>
    <nav>
      <a href="./index.html">Partidos</a>
      <a href="./equipos.html">Equipos</a>
    </nav>
    <h1>Partidos</h1>
    <script type="module" src="index.js"></script>
    <div class="games">
      <div class="game" onclick="toggleText(this)">
        <div class="details">
          <p class="fecha">2/3/2000</p>
        </div>
        <div class="teams">
          <div class="team">
            <div class="details"></div>
            <img src="" alt="" class="logo" />
            <p class="name">Colo Colo</p>
            <p class="score">5</p>
          </div>
          <p class="vs">vs</p>
          <div class="team">
            <img src="" alt="" class="logo" />
            <p class="name">Colo Colo</p>
            <p class="score">5</p>
          </div>
        </div>
      </div>
      <div class="game" onclick="toggleText(this)">
        <div class="details">
          <p class="fecha">2/3/2000</p>
        </div>
        <div class="teams">
          <div class="team">
            <div class="details"></div>
            <img src="" alt="" class="logo" />
            <p class="name">Colo Colo</p>
            <p class="score">5</p>
          </div>
          <p class="vs">vs</p>
          <div class="team">
            <img src="" alt="" class="logo" />
            <p class="name">Colo Colo</p>
            <p class="score">5</p>
          </div>
        </div>
      </div>
      <script>
        function toggleText(box) {
          var boxContents = box.querySelectorAll(".score");
          boxContents.forEach(function (content) {
            if (content.style.display === "none") {
              content.style.display = "block";
            } else {
              content.style.display = "none";
            }
          });
        }
      </script>
    </div>
    <p id="token"></p>
    <script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-messaging.js"></script>
    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyA-toGx8coidWYspBsuKWdIJuZp-dM_Pbs",
          authDomain: "pwa-g6.firebaseapp.com",
          projectId: "pwa-g6",
          storageBucket: "pwa-g6.appspot.com",
          messagingSenderId: "144479401328",
          appId: "1:144479401328:web:020cf45f116d226d1e8bb5",
          vapidKey: 'BLHZLAWEW1kvTgiPvKIb5dkmYgZACiBMHyO1_0PeIvWuzN8lZKLFK9LM1Z8BUzSzCchwc73C0ur4b5nSilJok18'
        };
        firebase.initializeApp(firebaseConfig);
        const messaging=firebase.messaging();
    
        function IntitalizeFireBaseMessaging() {
            messaging
                .requestPermission()
                .then(function () {
                    console.log("Notification Permission");
                    return messaging.getToken();
                })
                .then(function (token) {
                    console.log("Token : "+token);
                    document.getElementById("token").innerHTML=token;
                })
                .catch(function (reason) {
                    console.log(reason);
                });
        }
    
        messaging.onMessage(function (payload) {
            console.log(payload);
            const notificationOption={
                body:payload.notification.body,
                icon:payload.notification.icon
            };
    
            if(Notification.permission==="granted"){
                var notification=new Notification(payload.notification.title,notificationOption);
    
                notification.onclick=function (ev) {
                    ev.preventDefault();
                    window.open(payload.notification.click_action,'_blank');
                    notification.close();
                }
            }
    
        });
        messaging.onTokenRefresh(function () {
            messaging.getToken()
                .then(function (newtoken) {
                    console.log("New Token : "+ newtoken);
                })
                .catch(function (reason) {
                    console.log(reason);
                })
        })
        IntitalizeFireBaseMessaging();
    </script>
  </body>
</html>
